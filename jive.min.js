// Jive JS v0.3.3
(function(a){a.fn.drag=function(f,c,e){var b="string"==typeof f?f:"",d=a.isFunction(f)?f:a.isFunction(c)?c:null;0!==b.indexOf("drag")&&(b="drag"+b);e=(f==d?c:e)||{};return d?this.bind(b,e,d):this.trigger(b)};var b=a.event,d=b.special,e=d.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(f){var c=a.data(this,e.datakey),b=f.data||{};c.related+=1;a.each(e.defaults,function(a,f){void 0!==b[a]&&(c[a]=b[a])})},remove:function(){a.data(this,
e.datakey).related-=1},setup:function(){if(!a.data(this,e.datakey)){var f=a.extend({related:0},e.defaults);a.data(this,e.datakey,f);b.add(this,"touchstart mousedown",e.init,f);this.attachEvent&&this.attachEvent("ondragstart",e.dontstart)}},teardown:function(){(a.data(this,e.datakey)||{}).related||(a.removeData(this,e.datakey),b.remove(this,"touchstart mousedown",e.init),e.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",e.dontstart))},init:function(f){if(!e.touched){var c=f.data,l;
if(!(0!=f.which&&0<c.which&&f.which!=c.which||a(f.target).is(c.not)||c.handle&&!a(f.target).closest(c.handle,f.currentTarget).length)&&(e.touched="touchstart"==f.type?this:null,c.propagates=1,c.mousedown=this,c.interactions=[e.interaction(this,c)],c.target=f.target,c.pageX=f.pageX,c.pageY=f.pageY,c.dragging=null,l=e.hijack(f,"draginit",c),c.propagates&&((l=e.flatten(l))&&l.length&&(c.interactions=[],a.each(l,function(){c.interactions.push(e.interaction(this,c))})),c.propagates=c.interactions.length,
!1!==c.drop&&d.drop&&d.drop.handler(f,c),e.textselect(!1),e.touched?b.add(e.touched,"touchmove touchend",e.handler,c):b.add(document,"mousemove mouseup",e.handler,c),!e.touched||c.live)))return!1}},interaction:function(f,c){var b=a(f)[c.relative?"position":"offset"]()||{top:0,left:0};return{drag:f,callback:new e.callback,droppable:[],offset:b}},handler:function(f){var c=f.data;switch(f.type){case !c.dragging&&"touchmove":f.preventDefault();case !c.dragging&&"mousemove":if(Math.pow(f.pageX-c.pageX,
2)+Math.pow(f.pageY-c.pageY,2)<Math.pow(c.distance,2))break;f.target=c.target;e.hijack(f,"dragstart",c);c.propagates&&(c.dragging=!0);case "touchmove":f.preventDefault();case "mousemove":if(c.dragging){e.hijack(f,"drag",c);if(c.propagates){!1!==c.drop&&d.drop&&d.drop.handler(f,c);break}f.type="mouseup"}default:e.touched?b.remove(e.touched,"touchmove touchend",e.handler):b.remove(document,"mousemove mouseup",e.handler),c.dragging&&(!1!==c.drop&&d.drop&&d.drop.handler(f,c),e.hijack(f,"dragend",c)),
e.textselect(!0),!1===c.click&&c.dragging&&a.data(c.mousedown,"suppress.click",(new Date).getTime()+5),c.dragging=e.touched=!1}},hijack:function(f,c,d,g,k){if(d){var m=f.originalEvent,s=f.type,q=c.indexOf("drop")?"drag":"drop",n,r=g||0,h,p;g=isNaN(g)?d.interactions.length:g;f.type=c;f.originalEvent=null;d.results=[];do!(h=d.interactions[r])||"dragend"!==c&&h.cancelled||(p=e.properties(f,d,h),h.results=[],a(k||h[q]||d.droppable).each(function(g,k){p.target=k;f.isPropagationStopped=function(){return!1};
n=k?b.dispatch.call(k,f,p):null;!1===n?("drag"==q&&(h.cancelled=!0,d.propagates-=1),"drop"==c&&(h[q][g]=null)):"dropinit"==c&&h.droppable.push(e.element(n)||k);"dragstart"==c&&(h.proxy=a(e.element(n)||h.drag)[0]);h.results.push(n);delete f.result;if("dropinit"!==c)return n}),d.results[r]=e.flatten(h.results),"dropinit"==c&&(h.droppable=e.flatten(h.droppable)),"dragstart"!=c||h.cancelled||p.update());while(++r<g);f.type=s;f.originalEvent=m;return e.flatten(d.results)}},properties:function(a,c,d){var b=
d.callback;b.drag=d.drag;b.proxy=d.proxy||d.drag;b.startX=c.pageX;b.startY=c.pageY;b.deltaX=a.pageX-c.pageX;b.deltaY=a.pageY-c.pageY;b.originalX=d.offset.left;b.originalY=d.offset.top;b.offsetX=b.originalX+b.deltaX;b.offsetY=b.originalY+b.deltaY;b.drop=e.flatten((d.drop||[]).slice());b.available=e.flatten((d.droppable||[]).slice());return b},element:function(a){if(a&&(a.jquery||1==a.nodeType))return a},flatten:function(b){return a.map(b,function(c){return c&&c.jquery?a.makeArray(c):c&&c.length?e.flatten(c):
c})},textselect:function(b){a(document)[b?"unbind":"bind"]("selectstart",e.dontstart).css("MozUserSelect",b?"":"none");document.unselectable=b?"off":"on"},dontstart:function(){return!1},callback:function(){}};e.callback.prototype={update:function(){d.drop&&this.available.length&&a.each(this.available,function(a){d.drop.locate(this,a)})}};var m=b.dispatch;b.dispatch=function(b){if(0<a.data(this,"suppress."+b.type)-(new Date).getTime())a.removeData(this,"suppress."+b.type);else return m.apply(this,
arguments)};var k=b.fixHooks.touchstart=b.fixHooks.touchmove=b.fixHooks.touchend=b.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(b,c){if(c){var d=c.touches&&c.touches[0]||c.changedTouches&&c.changedTouches[0]||null;d&&a.each(k.props,function(a,c){b[c]=d[c]})}return b}};d.draginit=d.dragstart=d.dragend=e})(jQuery);
(function(a){var b=a.event,d=b.special.drag,e=d.add,m=d.teardown;d.noBubble=!1;d.livekey="livedrag";d.add=function(k){e.apply(this,arguments);var f=a.data(this,d.datakey);!f.live&&k.selector&&(f.live=!0,b.add(this,"draginit."+d.livekey,d.delegate))};d.teardown=function(){m.apply(this,arguments);var e=a.data(this,d.datakey)||{};e.live&&(b.remove(this,"draginit."+d.livekey,d.delegate),e.live=!1)};d.delegate=function(e){var f=[],c,l=a.data(this,"events")||{};a.each(l||[],function(g,l){0===g.indexOf("drag")&&
a.each(l||[],function(l,g){if(c=a(e.target).closest(g.selector,e.currentTarget)[0])b.add(c,g.origType+"."+d.livekey,g.origHandler||g.handler,g.data),0>a.inArray(c,f)&&f.push(c)})});return f.length?a(f).bind("dragend."+d.livekey,function(){b.remove(this,"."+d.livekey)}):!1}})(jQuery);(function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.create=function(d){function e(){!a&&this.initialize&&this.initialize.apply(this,arguments)}var m=this.prototype;a=!0;var k=new this;a=!1;for(var f in d)k[f]="function"==typeof d[f]&&"function"==typeof m[f]&&b.test(d[f])?function(a,b){return function(){var d=this._super;this._super=m[a];var e=b.apply(this,arguments);this._super=d;return e}}(f,d[f]):d[f];e.prototype=k;e.constructor=e;e.create=arguments.callee;
return e}})();window.$j={regex:{bit:/^(0|1)$/,num:/^-?([0-9]*)$/,alpha:/^[a-zA-z\s]+$/,alphanum:/^[a-zA-Z0-9]?[\s||\'||\"||\.||\?||\!||\-||a-zA-Z0-9]+$/,email:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,phone:/^([0-9]{3}( |-|.)?)?(\(?[0-9]{3}\)?|[0-9]{3})( |-|.)?([0-9]{3}( |-|.)?[0-9]{4}|[a-zA-Z0-9]{7})$/,cc:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,zip:/^(([0-9]{5})|([0-9]{5}[-][0-9]{4}))$/,
decimal:/^\d+\.\d{0,4}$/,price:/^\$?\s?[0-9\,]+(\.\d{0,4})?$/},init:function(a){this.tabbed={};this.forms={};this.slideshows={};this.popups={};this.popup_index=0;this.crontab={};this.crontab_index=0;this.cron(this.get_time,1E3,"jiveTime");$(document).ready(function(){$j.init_dom()})},init_dom:function(){$(document).mousemove(this.get_mouse_position);this.get_viewport_dimensions();$(window).resize(this.get_viewport_dimensions)},get_mouse_position:function(a){$j.mouse={x:a.pageX,y:a.pageY}},get_viewport_dimensions:function(){$j.viewport=
{x:$(window).width(),y:$(window).height()}},msg:function(a){this.Messenger.createMessage(a)},cron:function(a,b,d){d=d?d:this.crontab_index++;var e={created:new Date,stop:function(){clearTimeout(this.timer)},timer:setInterval(function(){a(e)},b)};this.crontab[d]=e},get_time:function(){var a=new Date;$j.time={hours:a.getHours(),mins:a.getMinutes(),secs:a.getSeconds(),time_of_day:"am"};10>$j.time.mins?$j.time.mins="0"+$j.time.mins:$j.time.mins=$j.time.mins;10>$j.time.secs?$j.time.secs="0"+$j.time.secs:
$j.time.secs=$j.time.secs;12<$j.time.hours&&($j.time.hours-=12,$j.time.time_of_day="pm")}};$j.init();window.$j.canopy={create:function(){$j.canopy.overlay=$('<div id="canopy"/>').append($('<div id="canopy-close"/>').text("x").click($j.canopy.close));$(document.body).append($j.canopy.overlay)},display:function(){0===$("#canopy").length&&$j.canopy.create();$j.canopy.overlay.show()},close:function(){$j.canopy.overlay.hide()}};$j.Messenger={index:0,messages:{},initialize:function(){var a=this;this.container=$('<div id="Messenger"/>');this.messageContainer=$('<div id="MessageList"/>');$(document).ready(function(){a.container.append(a.messageContainer);$(document.body).append(a.container)})},createMessage:function(a){var b=this;a=$.extend({id:"message-"+b.index,type:null,timer:5E3,sticky:!1},a);a.container=$('<div class="message" id="'+a.id+'"/>').append($('<div class="message-contents"/>').html(a.content).click(function(){b.removeMessage(a.id)}));
a.type&&a.container.addClass("message-"+a.type);a.sticky||setTimeout(function(){b.removeMessage(a.id)},a.timer);this.messageContainer.append(a.container);this.container.show();this.messages[a.id]=a;this.index++},removeMessage:function(a){$("#"+a).remove();delete this.messages[a]}};$j.Messenger.initialize();var Tabs=Class.create({initialize:function(a){var b=this;this.container_id=a.container;this.update_dom(this.container_id,a.index);this.check_hash();$j.tabbed[a.container]=this;window.onpopstate?window.onpopstate=function(a){b.check_hash()}:window.onhashchange=function(a){b.check_hash()}},check_hash:function(){var a=this,b=/#.+(?!\s)/g.exec(document.location);$.isArray(b)&&(tabID=b[0].replace("#",""),this.tabs.each(function(b){this.id=="tab-"+tabID&&a.show_tab(b)}))},update_dom:function(a,b){var d=
this;this.container=$("#"+a);this.tabs=this.container.find(".tab:not(#"+a+" .tabbed .tab)");this.panels=this.container.find(".panel:not(#"+a+" .tabbed .panel)");this.current_index=b?b:0;this.tabs.each(function(a){$(this).click(function(){d.current_index!=a&&d.show_tab(a)})});this.panels.hide();this.show_tab(this.current_index)},show_tab:function(a){var b=this;this.panels.hide().removeClass("current");this.tabs.removeClass("current");/^\d+$/.test(a)?this.current_index=a:this.tabs.each(function(e){this.id==
"tab-"+a&&(b.current_index=e)});var d="#"+this.tabs[this.current_index].id.replace("tab-","panel-");this.container.find("#"+this.tabs[this.current_index].id).addClass("current");this.container.find(d).show().addClass("current")},next_tab:function(){this.show_tab((this.current_index+1+this.tabs.length)%this.tabs.length)},previous_tab:function(){this.show_tab((this.current_index-1+this.tabs.length)%this.tabs.length)},add_tab:function(a){this.container.append(a.tab,a.panel);this.update_dom(this.container_id)}});
$(document).ready(function(){$(".tabbed").each(function(){this.id?new Tabs({container:this.id}):(console.error("Jive Tabbed UI [FAIL] > ID attribute required to make Tabbed UI but no found on element below:"),console.log(this))})});var JiveForm=Class.create({initialize:function(a){var b=this;this.container=$("#"+a);this.formName=this.container.attr("name");this.fields={text:this.container.find("input[type=text]"),textareas:this.container.find("textarea"),radios:this.container.find("input[type=radio]"),checkboxes:this.container.find("input[type=checkbox]"),selects:this.container.find("select"),submits:this.container.find("input[type=submit]"),buttons:this.container.find("button")};this.fields.buttons.click(function(a){a.preventDefault();
b.submit(a)});this.container.submit(function(a){b.submit(a)});$j.forms[a]=this},validate:function(){for(var a in this.fields)"submits"!=a&&"buttons"!=a&&this.fields[a].each(function(){$(this).attr("disabled","disabled");var a=$(this).data("validate");$j.regex[a]&&($j.regex[a].test(this.value)?$(this).addClass("valid").removeClass("invalid"):$(this).addClass("invalid").removeClass("valid"));$(this).removeAttr("disabled")});this.invalidFields=this.container.find(".invalid");return 0==this.invalidFields.length?
!0:!1},submit:function(a){a.preventDefault();if(this.validate()){this.data={};a=this.container.serializeArray();for(fieldID in a){var b=a[fieldID];this.data[b.name]=b.value}if(this.successCallBack)this.successCallBack(this);else return!0}else if(this.failureCallback)this.failureCallback(this);else return!1},success:function(a){this.successCallBack=a},failure:function(a){this.failureCallback=a},reset:function(){this.fields.text.each(function(){$(this).attr("value","")});this.fields.textarea.each(function(){$(this).attr("value",
"")})}});$(document).ready(function(){$(".jive-form").each(function(){new JiveForm(this.id)})});var Popup=Class.create({initialize:function(a){var b=this;a=$.extend({container:"popup-"+$j.popup_index++,title:"",html:!1,fullscreen:!1,top:($j.viewport.y-this.height)/2,left:($j.viewport.x-this.width)/2,offset:{top:50,left:50},confirm_close:!1,drag:!1,minimize:!1,resize_ondrag:!1},a);this.container_id=a.container;this.container=$('<div id="'+this.container_id+'" class="popup"/>').append($('<div class="popup-toolbar"/>').append($('<div class="popup-title"/>').html(a.title).append($('<div class="popup-close"/>').text("x").click(function(){b.close()}))));
this.content_container=$('<div id="'+this.container_id+'-contents" class="popup-contents" />');a.html&&this.set_contents(a.html.show());this.container.append(this.content_container);a.fullscreen&&(this.fullscreen=a.fullscreen,a.width=$j.viewport.x,a.height=$j.viewport.y);this.width=a.width;this.height=a.height;this.static_dimensions=a.width&&a.height&&!this.fullscreen?!0:!1;this.position={top:a.top,left:a.left,top_static:a.top?!0:!1,left_static:a.left?!0:!1};this.offset=a.offset;this.container.css({width:b.width,
height:b.height,top:b.position.top,left:b.position.left});this.confirm_close=a.confirm_close;this.drag=a.drag;this.minimize=a.minimize;this.resize_ondrag=a.resize_ondrag;$j.popups[this.container_id]=this;$(document.body).append(this.container);this.drag&&this.container.drag(function(a,b){$(this).css({top:b.offsetY,left:b.offsetX})},{handle:".popup-toolbar"});this.resize_ondrag&&(this.container.append($('<div class="popup-resize"/>')),this.container.drag("start",function(a,b){b.width=$(this).width();
b.height=$(this).height()}).drag(function(a,b){$(this).css({width:Math.max(20,b.width+b.deltaX),height:Math.max(20,b.height+b.deltaY)})},{handle:".popup-resize"}));$(window).resize(function(){b.update()});this.update()},update:function(){this.static_dimensions||this.resize();this.reposition();this.container.css({width:this.width,height:this.height,top:this.position.top,left:this.position.left})},reposition:function(){this.position.top_static||this.fullscreen||(this.position.top=($j.viewport.y-this.height)/
2,this.position.top<this.offset.top&&(this.position.top=this.offset.top));this.position.left_static||this.fullscreen||(this.position.left=($j.viewport.x-this.width)/2,this.position.left<this.offset.left&&(this.position.left=this.offset.left))},resize:function(){this.fullscreen?(this.width=$j.viewport.x,this.height=$j.viewport.y):(this.width=$j.viewport.x/2,this.height=$j.viewport.y/2)},close:function(a){this.confirm_close?confirm("Are you sure you would like to close this window?")&&(a?(this.container.remove(),
delete $j.popups[this.container_id]):this.container.hide()):a?(this.container.remove(),delete $j.popups[this.container_id]):this.container.hide()},set_title:function(a){this.container.find(".popup-title").html(a)},set_contents:function(a){this.content_container.html(a)}});$j.modal={display:function(a){a=$.extend({container:"modal"},a);new Popup(a);this.popup=$j.popups.modal;this.popup.fullscreen||($j.canopy.display(),$("#canopy-close").hide(),$("#modal").find(".popup-close").click(function(a){$j.canopy.close()}))},close:function(){this.popup.fullscreen||$j.canopy.close();this.popup.close()}};var Slideshow=Class.create({initialize:function(a){$j.slideshows[a]=this;this.container=$("#"+a);this.slides=this.container.find(".slide");a=this.container.data();this.slide_duration=a.duration?a.duration:5E3;this.autostart=a.autostart?a.autostart:!1;this.loop=a.loop?a.loop:!0;this.reverse=a.reverse?a.reverse:!1;this.transition_interval=a.transition_interval?a.transition_interval:200;this.current_index=this.reverse?this.slides.length-1:0;this.completed=this.playing=!1;this.slides.hide();this.show_slide(!0);
this.autostart&&this.start()},show_slide:function(){if(!this.loop&&this.current_index>=this.slides.length)return this.current_index=this.slides.length-1,this.stop(),!1;this.current_index>=this.slides.length&&(this.current_index=0);if(!this.loop&&0>this.current_index)return this.current_index=0,this.stop(),!1;0>this.current_index&&(this.current_index=this.slides.length-1);this.slides.fadeOut(this.transition_interval).removeClass("current");this.current_slide=$(this.slides[this.current_index]).addClass("current").fadeIn(this.transition_interval)},
start:function(){var a=this,b=$(this.container).attr("id");if(this.playing)return!1;this.reverse?(this.playing=!0,$j.cron(function(){a.previous_slide()},this.slide_duration,b)):(this.playing=!0,$j.cron(function(){a.next_slide()},this.slide_duration,b));this.completed=!1},stop:function(){var a=$(this.container).attr("id");$j.crontab[a].stop();this.completed=!0;this.playing=!1},restart:function(){if(this.playing)return!1;this.reset();this.start()},reset:function(){this.stop();this.current_index=this.reverse?
this.slides.length-1:0;this.show_slide()},next_slide:function(){this.current_index++;this.show_slide()},previous_slide:function(){this.current_index--;this.show_slide()}});$(document).ready(function(){$(".slideshow").each(function(){this.id?new Slideshow(this.id):(console.error("Jive Slideshow UI [FAIL] > ID attribute required to make Slideshow UI but no found on element below:"),console.log(this))})});
